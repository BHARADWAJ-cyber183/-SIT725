const fs = require('fs');
const path = require('path');

const dataPath = path.join(__dirname, '../data/scanResults.json');

const scanWebsite = (url) => {
  const vulnerabilities = [
    { type: 'SQL Injection', severity: 'High' },
    { type: 'Cross-Site Scripting (XSS)', severity: 'Medium' },
    { type: 'Outdated Software', severity: 'Low' },
  ];

  console.log(`Scanning ${url} for vulnerabilities...`);
  return vulnerabilities;
};

const saveScanResults = (result) => {
  let data = [];
  if (fs.existsSync(dataPath)) {
    data = JSON.parse(fs.readFileSync(dataPath, 'utf8'));
  }
  data.push(result);
  fs.writeFileSync(dataPath, JSON.stringify(data, null, 2));
};

const loadScanResults = () => {
  if (fs.existsSync(dataPath)) {
    return JSON.parse(fs.readFileSync(dataPath, 'utf8'));
  }
  return [];
};

module.exports = { scanWebsite, saveScanResults, loadScanResults };
