const fs = require('fs');
const path = require('path');

const scanResultsFile = path.join(__dirname, '../data/scanResults.json');

const scanWebsite = (url) => {
  // Simulated vulnerability scanner
  const vulnerabilities = [
    { type: 'SQL Injection', severity: 'High' },
    { type: 'Cross-Site Scripting (XSS)', severity: 'Medium' },
    { type: 'Outdated Software', severity: 'Low' }
  ];
  console.log(`Scanning ${url} for vulnerabilities...`);
  return vulnerabilities;
};

const saveScanResults = (scanResult) => {
  const results = loadScanResults();
  results.push(scanResult);
  fs.writeFileSync(scanResultsFile, JSON.stringify(results, null, 2));
};

const loadScanResults = () => {
  if (!fs.existsSync(scanResultsFile)) return [];
  const data = fs.readFileSync(scanResultsFile);
  return JSON.parse(data);
};

module.exports = { scanWebsite, saveScanResults, loadScanResults };
